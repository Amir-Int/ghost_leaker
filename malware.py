import socket
import platform
import psutil


HOST = "127.0.0.1"
PORT = 10000

SYSINFO_COMMAND = 1235
EXIT_COMMAND = 2304

def main():
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((HOST, PORT))
        while True:
            order_bytes = s.recv(8)
            order = int.from_bytes(order_bytes, "little", signed=False)
            if order == SYSINFO_COMMAND:
                system_info = ""
                system_info += f"System Platform:\t{platform.system()}\n"
                system_info += f"Host Name:\t\t{platform.node()}\n"
                system_info += f"Plt Version:\t\t{platform.release()}\n"
                system_info += f"Plt Build:\t\t{platform.version()}\n"
                system_info += f"Architecture:\t\t{platform.machine()}\n"
                system_info += f"Processor(s):\t\t{platform.processor()}\n"
                system_info += f"System Type:\t\t{platform.architecture()}\n"
                system_info += f"Boot Time: {psutil.boot_time()}\n"
                system_info += f"Users: {psutil.users()}\n"
                system_info += f"Virtual Memory: {psutil.virtual_memory()}\n"
                message_length = len(system_info).to_bytes(8, "little", signed=False)
                s.sendall(message_length)
                s.sendall(bytes(system_info, "utf-8"))
            elif order == EXIT_COMMAND:
                break

if __name__ == "__main__":
    main()